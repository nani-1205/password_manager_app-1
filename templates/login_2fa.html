{% extends "base.html" %}

{% block title %}Two-Factor Authentication{% endblock %}

{% block content %}
    <h1>Two-Factor Authentication Required</h1>
    <p>Please enter your master password again and the code from your authenticator app.</p>
    <form method="POST" action="{{ url_for('login_2fa') }}">
        <div class="form-group">
            <label for="password">Master Password:</label>
            <input type="password" id="password" name="password" required autocomplete="current-password">
        </div>
         <div class="form-group">
            <label for="totp_code">Authenticator Code:</label>
            <input type="text" id="totp_code" name="totp_code" required autocomplete="one-time-code" inputmode="numeric" pattern="[0-9]*">
        </div>
        <button type="submit">Verify & Login</button>
    </form>
     <p style="margin-top: 15px;"><a href="{{ url_for('logout') }}">Cancel Login</a></p> {# Allow user to cancel #}
{% endblock %}